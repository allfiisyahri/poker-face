<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Funny Poker Face Smash</title>
  <style>
    html, body {
      margin: 0;
      overflow: hidden;
      touch-action: manipulation;
    }
    canvas {
      display: block;
      background: linear-gradient(120deg, #1c1c1c, #333);
    }
  </style>
</head>
<body>
<canvas id="game"></canvas>
<script>
const canvas = document.getElementById('game');
const ctx = canvas.getContext('2d');
let W = canvas.width = window.innerWidth;
let H = canvas.height = window.innerHeight;

window.addEventListener('resize', () => {
  W = canvas.width = window.innerWidth;
  H = canvas.height = window.innerHeight;
});

// Game state
let bosses = 50;
let currentBoss = 1;
let bossHealth = 10;
let maxHealth = bossHealth;
let faces = [];
let particles = [];
let score = 0;
let colors = ['#FF416C', '#FF4B2B', '#2193b0', '#6dd5ed', '#ee9ca7', '#ffdde1', '#8360c3', '#2ebf91'];

function randomColor() {
  return colors[Math.floor(Math.random() * colors.length)];
}

class PokerFace {
  constructor() {
    this.x = Math.random() * (W - 100) + 50;
    this.y = Math.random() * (H - 150) + 75;
    this.size = 80;
    this.color = randomColor();
  }

  draw() {
    ctx.beginPath();
    ctx.fillStyle = this.color;
    ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
    ctx.fill();
    ctx.fillStyle = "#fff";
    ctx.font = "20px Arial";
    ctx.textAlign = "center";
    ctx.fillText("üòê", this.x, this.y + 7);
  }

  isClicked(x, y) {
    const dx = this.x - x;
    const dy = this.y - y;
    return dx * dx + dy * dy <= this.size * this.size;
  }
}

function spawnFace() {
  faces = [new PokerFace()];
}

function spawnParticles(x, y, color) {
  for (let i = 0; i < 20; i++) {
    particles.push({
      x,
      y,
      vx: (Math.random() - 0.5) * 4,
      vy: (Math.random() - 0.5) * 4,
      size: Math.random() * 4 + 2,
      alpha: 1,
      color
    });
  }
}

function updateParticles() {
  particles = particles.filter(p => p.alpha > 0.05);
  particles.forEach(p => {
    p.x += p.vx;
    p.y += p.vy;
    p.alpha *= 0.95;
    ctx.globalAlpha = p.alpha;
    ctx.fillStyle = p.color;
    ctx.beginPath();
    ctx.arc(p.x, p.y, p.size, 0, Math.PI * 2);
    ctx.fill();
    ctx.globalAlpha = 1;
  });
}

// Game loop
function gameLoop() {
  ctx.fillStyle = "#111";
  ctx.fillRect(0, 0, W, H);

  // Draw background gradient based on boss level
  let grd = ctx.createLinearGradient(0, 0, W, H);
  grd.addColorStop(0, colors[currentBoss % colors.length]);
  grd.addColorStop(1, "#000");
  ctx.fillStyle = grd;
  ctx.fillRect(0, 0, W, H);

  faces.forEach(f => f.draw());
  updateParticles();

  // HUD
  ctx.fillStyle = "#fff";
  ctx.font = "18px Arial";
  ctx.fillText(`Boss: ${currentBoss}/${bosses}`, 20, 30);
  ctx.fillText(`Health: ${bossHealth}/${maxHealth}`, 20, 60);
  ctx.fillText(`Score: ${score}`, 20, 90);

  requestAnimationFrame(gameLoop);
}

// Touch / Click handler
canvas.addEventListener("click", handleClick);
canvas.addEventListener("touchstart", e => {
  const touch = e.touches[0];
  handleClick({ clientX: touch.clientX, clientY: touch.clientY });
});

function handleClick(e) {
  const x = e.clientX;
  const y = e.clientY;
  for (let f of faces) {
    if (f.isClicked(x, y)) {
      bossHealth--;
      score++;
      spawnParticles(f.x, f.y, f.color);
      if (bossHealth <= 0) {
        currentBoss++;
        if (currentBoss > bosses) {
          alert("üéâ You beat all the poker faces! Final Score: " + score);
          location.reload();
        } else {
          bossHealth = 10 + currentBoss * 2;
          maxHealth = bossHealth;
          spawnFace();
        }
      }
      break;
    }
  }
}

// Start the game
spawnFace();
gameLoop();
</script>
</body>
</html>
